<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!--

   Copyright 2010 OpenEngSB Division, Vienna University of Technology

   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.

-->
<chapter id="issueDomain" xmlns="http://docbook.org/ns/docbook">
  <title id="issueDomain.title">Issue Tracker Domain</title>
  
  <warning>
    <para>
      This page is only a proposal! This means that everyone is allowed to edit this page and it is 
      marked for change. This proposal could be seen as design idea and should be discussed in public
      and visible for everyone before implemented at all.
    </para>
  </warning>

  <para>
  This page provides object and interface descriptions needed for the integration of issue tracking systems into OpenEngSB.
  The mapping between the interface of the specific issue tracker and OpenEngSB is designed to
  be easily extensible (e.g. adding new fields from issue trackers). There are a lot of issue trackers on the market.
  The focus lies on open source issue trackers. To model the interface 4 widespread systems were chosen:
  <itemizedlist>
    <listitem>Mantis</listitem>
    <listitem>GitHub</listitem>
    <listitem>Bugzilla</listitem>
    <listitem>Trac</listitem>
  </itemizedlist>
  </para>
    
  <section>
    <title>Comparison</title>

    Issue/Task

    <informaltable>
      <thead>
        <tr>
          <td>Fields/Options</td>
          <td>Type</td>
          <td>Short description</td>
          <td>Mantis</td>
          <td>GitHub</td>
          <td>Bugzilla</td>
          <td>Trac</td>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>id</td>
          <td>long or int</td>
          <td>identify the issue</td>
          <td>+</td>
          <td>+</td>
          <td>+</td>
          <td>+</td>
        </tr>
        <tr>
          <td>project</td>
          <td>String</td>
          <td>The name of the product/project the bug is being filed against</td>
          <td>+</td>
          <td>-</td>
          <td>+</td>
          <td>+</td>
        </tr>
        <tr>
          <td>component</td>
          <td>String</td>
          <td>The name of a component in the product above. 1) Different meanings</td>
          <td>-</td>
          <td>-</td>
          <td>+</td>
          <td>-</td>
        </tr>
        <tr>
          <td>summary or title</td>
          <td>String</td>
          <td>A brief description of the bug being filed.</td>
          <td>+</td>
          <td>+</td>
          <td>+</td>
          <td>+</td>
        </tr>
        <tr>
          <td>version</td>
          <td>String</td>
          <td>A version of the product above; the version the bug was found in.</td>
          <td>+</td>
          <td>-</td>
          <td>+</td>
          <td>+</td>
        </tr>
        <tr>
          <td>description</td>
          <td>String</td>
          <td>The initial description for this bug.</td>
          <td>+</td>
          <td>+</td>
          <td>+</td>
          <td>+</td>
        </tr>
        <tr>
          <td>os</td>
          <td>String</td>
          <td>The operating system the bug was discovered on.</td>
          <td>+</td>
          <td>-</td>
          <td>+</td>
          <td>-</td>
        </tr>
        <tr>
          <td>os version</td>
          <td>String</td>
          <td>The version of the operating system.</td>
          <td>+</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
        </tr>
        <tr>
          <td>platform</td>
          <td>String</td>
          <td>What type of hardware the bug was experienced on.</td>
          <td>+</td>
          <td>-</td>
          <td>+</td>
          <td>-</td>
        </tr>
        <tr>
          <td>priority</td>
          <td>String</td>
          <td>What order the bug will be fixed in by the developer, compared to the developers other bugs.</td>
          <td>+</td>
          <td>-</td>
          <td>+</td>
          <td>+</td>
        </tr>
        <tr>
          <td>severity</td>
          <td>String</td>
          <td>How severe the bug is.</td>
          <td>+</td>
          <td>-</td>
          <td>+</td>
          <td>+</td>
        </tr>
        <tr>
          <td>alias</td>
          <td>String</td>
          <td>The alias of this bug. If there is no alias or aliases are disabled, this will be an empty string.</td>
          <td>-</td>
          <td>-</td>
          <td>+</td>
          <td>-</td>
        </tr>
        <tr>
          <td>assigned_to / owner</td>
          <td>String</td>
          <td>The login name of the user to whom the bug is assigned.</td>
          <td>+</td>
          <td>-</td>
          <td>+</td>
          <td>+</td>
        </tr>
        <tr>
          <td>creation_time</td>
          <td>Date</td>
          <td>When the bug was created.</td>
          <td>+</td>
          <td>+</td>
          <td>+</td>
          <td>+</td>
        </tr>
        <tr>
          <td>dupe_of</td>
          <td>int</td>
          <td>The bug ID of the bug that this bug is a duplicate of. If this bug isn't a duplicate of any bug, this will be an empty int.</td>
          <td>-</td>
          <td>-</td>
          <td>+</td>
          <td>-</td>
        </tr>
        <tr>
          <td>is_open</td>
          <td>boolean</td>
          <td>Returns true (1) if this bug is open, false (0) if it is closed.</td>
          <td>-</td>
          <td>-</td>
          <td>+</td>
          <td>-</td>
        </tr>
        <tr>
          <td>update_time</td>
          <td>Date</td>
          <td>When the bug was last changed.</td>
          <td>+</td>
          <td>+</td>
          <td>+</td>
          <td>+</td>
        </tr>
        <tr>
          <td>status</td>
          <td>String</td>
          <td>The current status of the bug.</td>
          <td>+</td>
          <td>-</td>
          <td>+</td>
          <td>+</td>
        </tr>
        <tr>
          <td>creation time</td>
          <td>Date</td>
          <td>When the bug was created.</td>
          <td>-</td>
          <td>-</td>
          <td>+</td>
          <td>-</td>
        </tr>
        <tr>
          <td>resolution</td>
          <td>String</td>
          <td>The current resolution of the bug, or an empty string if the bug is open.</td>
          <td>+</td>
          <td>-</td>
          <td>+</td>
          <td>+</td>
        </tr>
        <tr>
          <td>reporter</td>
          <td>String</td>
          <td>The author of the ticket.</td>
          <td>+</td>
          <td>+</td>
          <td>-</td>
          <td>+</td>
        </tr>
        <tr>
          <td>monitor</td>
          <td>String</td>
          <td>The persons who monitor the issue.</td>
          <td>+</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
        </tr>
        <tr>
          <td>keywords</td>
          <td>String</td>
          <td>Keywords that a ticket is marked with. Useful for searching and report generation.</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>+</td>
        </tr>
        <tr>
          <td>milestone / targetversion</td>
          <td>String</td>
          <td>When this issue should be resolved at the latest.</td>
          <td>+</td>
          <td>-</td>
          <td>-</td>
          <td>+</td>
        </tr>
        <tr>
          <td>cc</td>
          <td>String</td>
          <td>A comma-separated list of other users or E-Mail addresses to notify. Note that this does not imply responsiblity or any other policy.</td>
          <td>-</td>
          <td>-</td>
          <td>+</td>
          <td>+</td>
        </tr>
        <tr>
          <td>fixed in version</td>
          <td>String</td>
          <td>The version the issue was fixed</td>
          <td>+</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
        </tr>
        <tr>
          <td>type</td>
          <td>String</td>
          <td>The nature of the ticket (for example, defect or enhancement request) or self-defined categories</td>
          <td>+</td>
          <td>-</td>
          <td>-</td>
          <td>+</td>
        </tr>
        <tr>
          <td>view state</td>
          <td>String</td>
          <td>The view state describes the point of view(public, private, any).</td>
          <td>+</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
        </tr>
        <tr>
          <td>build</td>
          <td>String</td>
          <td>The version of the build</td>
          <td>+</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
        </tr>
        <tr>
          <td>notes</td>
          <td>List</td>
          <td>Added notes after creation.</td>
          <td>+</td>
          <td>+</td>
          <td>+</td>
          <td>-</td>
        </tr>
        <tr>
          <td>addtional information</td>
          <td>String</td>
          <td>These information should give more details of the issue.</td>
          <td>+</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
        </tr>
        <tr>
          <td>steps to reproduce</td>
          <td>String</td>
          <td>If it is a bug, you can describe what you have to do to reproduce the error.</td>
          <td>+</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
        </tr>
        <tr>
          <td>eta</td>
          <td>String</td>
          <td>no info</td>
          <td>+</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
        </tr>
        <tr>
          <td>projection</td>
          <td>String</td>
          <td>no info</td>
          <td>+</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
        </tr>
        <tr>
          <td>votes</td>
          <td>int</td>
          <td>You can vote to prioritise the open issue. This option is for opensource project to integrate all internal and external members</td>
          <td>-</td>
          <td>-</td>
          <td>+</td>
          <td>-</td>
        </tr>
      </tbody>
    </informaltable>
  </section>

  
  <section>
    <title>Issue Object</title>
    
    <para>

    We decided to use the least common delimiter to keep the issue object as small as possible while still containing all the basic features.
  
    Used Fields:
    
    <itemizedlist>
      <listitem>id</listitem>
      <listitem>summary</listitem>
      <listitem>description</listitem>
      <listitem>owner</listitem>
      <listitem>reporter</listitem>
      <listitem>priority (immediate, urgent, high, normal, low, none)</listitem>
      <listitem>status (new, assigned, closed)</listitem>
    </itemizedlist>
  
    We are using constants for priority and status instead of enums because they can't be accessed in Drools which will most likely get fixed with version 5.1
  
    Comments are added to the issue via the addComment function of the domain.
  
    </para>
  </section>
  
  
  <section>
    <title>Issue Domain</title>
    
    <para>
      The domain currently implements four basic methods (see interface description):
  
      <itemizedlist>
        <listitem>createIssue</listitem>
        <listitem>addComment</listitem>
        <listitem>updateIssue</listitem>
        <listitem>deleteIssue</listitem>
      </itemizedlist>
    </para>
  </section>
  
  <section>
    <title>Projects</title>

    <para>
      The project will be handled by the connectors. Basically there will be one endpoint per project per connector.
      The connector needs to add the issue to the right project.
      See tracConnector for Examples
    </para>
  </section>
  
  <section>
    <title>Interface description</title>


<programlisting><![CDATA[package org.openengsb.drools;

import java.util.Hashtable;

import org.openengsb.drools.model.Issue;

public interface IssuesDomain extends Domain {
    Integer createIssue(Issue issue);

    void updateIssue(Integer id, String comment, Hashtable<String, Object> changes);

    void deleteIssue(Integer id);
    
    void addComment(Integer id, String comment);
}]]></programlisting>
</section>



<section>
  <title>Domain model</title>

  <section>
    <title>Domain object for Issue/Task/Bug</title>
    
    <programlisting><![CDATA[package org.openengsb.drools.model;

public class Issue {
    private Integer id;
    private String summary;
    private String description;
    private String owner;
    private String reporter;
    private String priority;
    private String status;
}]]></programlisting>
  </section>
  
  <section>
    <title>Constants</title>
    
     <programlisting><![CDATA[/**
 * Priorities
 */
	public final static String priorityIMMEDIATE = "IMMEDIATE";
	public final static String priorityURGENT = "URGENT";
	public final static String priorityHIGH = "HIGH";
	public final static String priorityNORMAL = "NORMAL";
	public final static String priorityLOW = "LOW";
	public final static String priorityNONE = "NONE";


/**
 * Status
 */
	public final static String statusNEW = "NEW";
	public final static String statusASSIGNED = "ASSIGNED";
	public final static String statusCLOSED = "CLOSED";

/**
 * fields that are used for the changes Hashtable in updateIssue
 */
	public final static String fieldSUMMARY = "SUMMARY";
	public final static String fieldDESCRIPTION = "DESCRIPTION";
	public final static String fieldOWNER = "OWNER";
	public final static String fieldREPORTER = "REPORTER";
	public final static String fieldPRIORITY = "PRIORITY";
	public final static String fieldSTATUS = "STATUS";]]></programlisting>
</section>
</section>
</chapter>
